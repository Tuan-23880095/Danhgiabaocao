<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ƒê√°nh Gi√° ƒê·ªãa Th·ªëng K√™ - L·ªõp 5 SV</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body { font-family: 'Segoe UI', sans-serif; background-color: #f8fafc; }
        .score-input:checked + label { background-color: #2563eb; color: white; border-color: #2563eb; }
        .hidden-section { display: none; }
    </style>
</head>
<body class="text-gray-800 pb-24">

    <!-- Header -->
    <header class="bg-indigo-900 text-white p-4 shadow-lg sticky top-0 z-50">
        <div class="max-w-2xl mx-auto">
            <h1 class="text-lg font-bold uppercase"><i class="fas fa-chart-area mr-2"></i>ƒê√°nh Gi√° ƒê·ªãa Th·ªëng K√™</h1>
            <p class="text-xs text-indigo-200">L·ªõp Gi·∫£ng vi√™n m√¥n ƒê·ªãa th·ªëng k√™</p>
        </div>
    </header>

    <main class="max-w-2xl mx-auto p-4">
        
        <!-- C·∫•u h√¨nh Phi·∫øu -->
        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-5 mb-5">
            <h2 class="text-sm font-bold text-gray-500 uppercase tracking-wider mb-4 border-b pb-2">Th√¥ng tin ƒë√°nh gi√°</h2>
            
            <div class="space-y-4">
                <!-- Ng∆∞·ªùi ch·∫•m -->
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-1">Ng∆∞·ªùi ch·∫•m (B·∫°n l√† ai?)</label>
                    <select id="evaluator" class="w-full p-2.5 bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none">
                        <option value="">-- Ch·ªçn t√™n c·ªßa b·∫°n --</option>
                        <option value="Gi·∫£ng Vi√™n">Gi·∫£ng Vi√™n</option>
                        <!-- JS will insert students here -->
                    </select>
                </div>

                <!-- Ng∆∞·ªùi tr√¨nh b√†y -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-1">Sinh vi√™n tr√¨nh b√†y 1</label>
                        <select id="presenter1" class="w-full p-2.5 bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none">
                            <option value="">-- Ch·ªçn SV tr√¨nh b√†y --</option>
                            <!-- JS will insert students here -->
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-1">Sinh vi√™n tr√¨nh b√†y 2 (N·∫øu c√≥)</label>
                        <select id="presenter2" class="w-full p-2.5 bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none">
                            <option value="">-- Kh√¥ng c√≥ --</option>
                            <!-- JS will insert students here -->
                        </select>
                    </div>
                </div>

                <!-- Ch·ªß ƒë·ªÅ -->
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-1">N·ªôi dung ƒëang ch·∫•m</label>
                    <select id="topicSelect" onchange="filterRubric()" class="w-full p-2.5 bg-blue-50 border border-blue-300 text-blue-900 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none font-bold">
                        <option value="ALL">üî¥ ƒê√°nh gi√° T·∫§T C·∫¢ n·ªôi dung</option>
                        <option value="P1">üîµ Ph·∫ßn 1: Bi·∫øn ƒë·ªì (Variogram)</option>
                        <option value="P2">üü¢ Ph·∫ßn 2: Simple Kriging (SK)</option>
                        <option value="P3">üü£ Ph·∫ßn 3: Ordinary Kriging (OK)</option>
                    </select>
                    <p class="text-xs text-gray-500 mt-1">*Ch·ªçn ƒë√∫ng n·ªôi dung ƒë·ªÉ ·∫©n c√°c ph·∫ßn kh√¥ng li√™n quan.</p>
                </div>
            </div>
        </div>

        <!-- Rubric Container -->
        <form id="evaluationForm">
            <div id="rubricContainer"></div>

            <!-- B√†i t·∫≠p chung & T·ªïng k·∫øt -->
            <div id="commonSection" class="bg-white rounded-xl shadow-sm border border-gray-200 p-5 mb-5 border-l-4 border-gray-500">
                <h3 class="font-bold text-lg text-gray-800 mb-3">Ph·∫ßn B√†i T·∫≠p & Nh·∫≠n X√©t Chung</h3>
                
                <!-- B√†i t·∫≠p -->
                 <div class="mb-6">
                    <p class="font-semibold text-sm text-gray-700 mb-2">ƒê√°nh gi√° ph·∫ßn h∆∞·ªõng d·∫´n b√†i t·∫≠p:</p>
                    <div class="flex justify-between items-center bg-gray-50 p-3 rounded-lg">
                        <span class="text-xs font-bold text-gray-400">K√©m</span>
                        <div class="flex space-x-2">
                            <div class="text-center"><input type="radio" name="exercise" value="1" class="hidden score-input" onchange="calculateTotal()"><label class="w-8 h-8 flex items-center justify-center border rounded-full cursor-pointer hover:bg-gray-200">1</label></div>
                            <div class="text-center"><input type="radio" name="exercise" value="2" class="hidden score-input" onchange="calculateTotal()"><label class="w-8 h-8 flex items-center justify-center border rounded-full cursor-pointer hover:bg-gray-200">2</label></div>
                            <div class="text-center"><input type="radio" name="exercise" value="3" class="hidden score-input" onchange="calculateTotal()"><label class="w-8 h-8 flex items-center justify-center border rounded-full cursor-pointer hover:bg-gray-200">3</label></div>
                            <div class="text-center"><input type="radio" name="exercise" value="4" class="hidden score-input" onchange="calculateTotal()"><label class="w-8 h-8 flex items-center justify-center border rounded-full cursor-pointer hover:bg-gray-200">4</label></div>
                            <div class="text-center"><input type="radio" name="exercise" value="5" class="hidden score-input" onchange="calculateTotal()"><label class="w-8 h-8 flex items-center justify-center border rounded-full cursor-pointer hover:bg-gray-200">5</label></div>
                        </div>
                        <span class="text-xs font-bold text-gray-400">T·ªët</span>
                    </div>
                 </div>

                <!-- Textarea -->
                <div class="space-y-3">
                    <div>
                        <label class="block text-xs font-bold text-green-600 uppercase mb-1">ƒêi·ªÉm m·∫°nh</label>
                        <textarea id="feedback_strong" rows="2" class="w-full p-2 border border-gray-200 rounded focus:ring-1 focus:ring-green-500 outline-none text-sm" placeholder="Nh√≥m l√†m t·ªët ƒëi·ªÅu g√¨..."></textarea>
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-red-500 uppercase mb-1">C·∫ßn c·∫£i thi·ªán</label>
                        <textarea id="feedback_weak" rows="2" class="w-full p-2 border border-gray-200 rounded focus:ring-1 focus:ring-red-500 outline-none text-sm" placeholder="Nh√≥m c·∫ßn kh·∫Øc ph·ª•c g√¨..."></textarea>
                    </div>
                </div>
            </div>
        </form>

    </main>

    <!-- Footer Submit -->
    <div class="fixed bottom-0 left-0 w-full bg-white border-t shadow-lg z-40 p-3">
        <div class="max-w-2xl mx-auto flex items-center justify-between">
            <div class="flex flex-col">
                <span class="text-xs text-gray-500">T·ªïng ƒëi·ªÉm:</span>
                <span id="totalScoreDisplay" class="font-bold text-2xl text-blue-600 leading-none">0</span>
            </div>
            <button type="button" onclick="submitForm()" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-xl shadow-lg transition transform active:scale-95 flex items-center">
                G·ª≠i ƒêi·ªÉm <i class="fas fa-paper-plane ml-2"></i>
            </button>
        </div>
    </div>

    <!-- Notification Modal -->
    <div id="statusModal" class="fixed inset-0 z-50 flex items-center justify-center hidden bg-black bg-opacity-50 backdrop-blur-sm">
        <div class="bg-white rounded-xl p-6 shadow-2xl max-w-sm w-full mx-4 text-center">
            <div id="modalIcon" class="text-5xl mb-4"></div>
            <h3 id="modalTitle" class="text-xl font-bold mb-2"></h3>
            <p id="modalMessage" class="text-gray-600 mb-6"></p>
            <button onclick="closeModal()" class="w-full bg-gray-100 hover:bg-gray-200 text-gray-800 font-bold py-3 rounded-lg transition">ƒê√≥ng</button>
        </div>
    </div>

    <!-- Loading -->
    <div id="loadingOverlay" class="fixed inset-0 z-50 flex items-center justify-center hidden bg-white bg-opacity-90">
        <div class="text-center">
            <div class="animate-spin rounded-full h-10 w-10 border-4 border-blue-600 border-t-transparent mx-auto mb-3"></div>
            <p class="text-blue-800 font-medium animate-pulse">ƒêang ƒë·ªìng b·ªô d·ªØ li·ªáu...</p>
        </div>
    </div>

    <script>
        // --- CONFIGURATION ---
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwKeTMSqe5fDYbjPS5JkhAaiHkwWYGDoOkCmvQXxp5LkInboOgZt4S7lXh_40D7VEl8wg/exec";
        
        const STUDENTS = [
            {id: "20160011", name: "20160011 - L√ä CH√ç B·∫∞NG"},
            {id: "22160001", name: "22160001 - NGUY·ªÑN NG·ªåC THI√äN √ÇN"},
            {id: "22160003", name: "22160003 - NGUY·ªÑN PH√ö H√íA"},
            {id: "22160014", name: "22160014 - PHAN TH·ªä PH∆Ø∆†NG TH·∫¢O"},
            {id: "22160015", name: "22160015 - NGUY·ªÑN TR·∫¶N TR·ªåNG"}
        ];

        // D·ªØ li·ªáu Rubric chia theo M√£ ch·ªß ƒë·ªÅ (code)
        // code kh·ªõp v·ªõi value trong <select id="topicSelect">
        const rubricData = [
            {
                code: "P1",
                title: "Ph·∫ßn 1: Bi·∫øn ƒë·ªì (Variogram)",
                color: "border-indigo-500",
                icon: "text-indigo-600",
                criteria: [
                    { id: "1.1", label: "Kh√°i ni·ªám & ƒê·ªãnh nghƒ©a", desc: "ƒê·ªãnh nghƒ©a Variogram & C√¥ng th·ª©c th·ª±c nghi·ªám" },
                    { id: "1.2", label: "C√°c tham s·ªë quan tr·ªçng", desc: "Nugget effect (C0), Sill, Range (a)" },
                    { id: "1.3", label: "M√¥ h√¨nh h√≥a", desc: "M√¥ h√¨nh l√Ω thuy·∫øt & Fitting" },
                    { id: "1.4", label: "T√≠nh ch·∫•t", desc: "T√≠nh d·ª´ng & ƒê·∫≥ng h∆∞·ªõng/D·ªã h∆∞·ªõng" }
                ]
            },
            {
                code: "P2",
                title: "Ph·∫ßn 2: Simple Kriging (SK)",
                color: "border-green-500",
                icon: "text-green-600",
                criteria: [
                    { id: "2.1", label: "Gi·∫£ thi·∫øt c∆° b·∫£n", desc: "Trung b√¨nh ƒë√£ bi·∫øt & h·∫±ng ƒë·ªãnh" },
                    { id: "2.2", label: "Nguy√™n l√Ω t√≠nh to√°n", desc: "C√¥ng th·ª©c & x√°c ƒë·ªãnh tr·ªçng s·ªë" },
                    { id: "2.3", label: "∆Øu & Nh∆∞·ª£c ƒëi·ªÉm", desc: "ƒê∆°n gi·∫£n nh∆∞ng √≠t th·ª±c t·∫ø" }
                ]
            },
            {
                code: "P3",
                title: "Ph·∫ßn 3: Ordinary Kriging (OK)",
                color: "border-purple-500",
                icon: "text-purple-600",
                criteria: [
                    { id: "3.1", label: "Gi·∫£ thi·∫øt c∆° b·∫£n", desc: "Trung b√¨nh ch∆∞a bi·∫øt nh∆∞ng h·∫±ng ƒë·ªãnh" },
                    { id: "3.2", label: "H·ªá ph∆∞∆°ng tr√¨nh", desc: "H·ªá PT Kriging & Nh√¢n t·ª≠ Lagrange" },
                    { id: "3.3", label: "T√≠nh ch·∫•t n·ªôi suy", desc: "BLUE & Exact Interpolator" },
                    { id: "3.4", label: "∆Øu & Nh∆∞·ª£c ƒëi·ªÉm", desc: "M·∫°nh m·∫Ω, kh√¥ng c·∫ßn bi·∫øt mean tr∆∞·ªõc" }
                ]
            },
            {
                code: "ALL", // Ph·∫ßn n√†y lu√¥n hi·ªán n·∫øu ch·ªçn ALL, ho·∫∑c c√≥ th·ªÉ ·∫©n ƒëi
                title: "Ph·∫ßn 4: ·ª®ng d·ª•ng & So s√°nh",
                color: "border-yellow-500",
                icon: "text-yellow-600",
                criteria: [
                    { id: "4.1", label: "So s√°nh SK v√† OK", desc: "Ph√¢n bi·ªát gi·∫£ thi·∫øt & r√†ng bu·ªôc" },
                    { id: "4.2", label: "·ª®ng d·ª•ng th·ª±c ti·ªÖn", desc: "V√≠ d·ª• kho√°ng s·∫£n, m√¥i tr∆∞·ªùng..." }
                ]
            }
        ];

        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => {
            populateStudentLists();
            renderRubric();
        });

        function populateStudentLists() {
            const selects = ['evaluator', 'presenter1', 'presenter2'];
            selects.forEach(id => {
                const el = document.getElementById(id);
                STUDENTS.forEach(st => {
                    const option = document.createElement('option');
                    option.value = st.name;
                    option.text = st.name;
                    el.appendChild(option);
                });
            });
        }

        function renderRubric() {
            const container = document.getElementById('rubricContainer');
            let html = '';

            rubricData.forEach((section) => {
                // T·∫°o ID cho section ƒë·ªÉ d·ªÖ ·∫©n hi·ªán
                html += `
                <div id="section_${section.code}" class="rubric-section bg-white rounded-xl shadow-sm border border-gray-200 p-4 mb-4 border-l-4 ${section.color}">
                    <h3 class="font-bold text-lg text-gray-800 mb-3 flex items-center">
                        <i class="fas fa-check-circle mr-2 ${section.icon}"></i> ${section.title}
                    </h3>
                    <div class="space-y-4">
                `;

                section.criteria.forEach((crit) => {
                    html += `
                    <div class="pb-3 border-b border-gray-100 last:border-0 last:pb-0">
                        <div class="mb-2">
                            <span class="font-semibold text-sm text-gray-700 block">${crit.id}. ${crit.label}</span>
                            <span class="text-xs text-gray-400">${crit.desc}</span>
                        </div>
                        
                        <div class="flex justify-between items-center bg-gray-50 p-2 rounded-lg">
                            <span class="text-xs font-bold text-gray-400 w-6">1</span>
                            <div class="flex space-x-1 md:space-x-4 w-full justify-center">
                                ${[1, 2, 3, 4, 5].map(score => `
                                    <div class="text-center w-full">
                                        <input type="radio" name="${crit.id}" id="${crit.id}_${score}" value="${score}" class="hidden score-input" onchange="calculateTotal()">
                                        <label for="${crit.id}_${score}" class="w-8 h-8 md:w-10 md:h-10 flex mx-auto items-center justify-center border border-gray-300 rounded-full cursor-pointer hover:bg-blue-100 transition text-sm font-bold">
                                            ${score}
                                        </label>
                                    </div>
                                `).join('')}
                            </div>
                            <span class="text-xs font-bold text-gray-400 w-6 text-right">5</span>
                        </div>
                    </div>
                    `;
                });

                html += `</div></div>`;
            });

            container.innerHTML = html;
        }

        // --- LOGIC: FILTER SECTIONS ---
        function filterRubric() {
            const selectedTopic = document.getElementById('topicSelect').value;
            const sections = document.querySelectorAll('.rubric-section');
            
            sections.forEach(sec => {
                const secId = sec.id.replace('section_', '');
                
                if (selectedTopic === 'ALL') {
                    sec.classList.remove('hidden-section');
                } else {
                    // Logic: 
                    // N·∫øu ch·ªçn P1 -> Hi·ªán P1
                    // Lu√¥n hi·ªán ph·∫ßn 4 (ALL) n·∫øu mu·ªën, ho·∫∑c ch·ªâ hi·ªán ƒë√∫ng P1.
                    // ·ªû ƒë√¢y t√¥i ƒë·ªÉ logic ch·∫∑t: Ch·ªçn P1 ch·ªâ hi·ªán P1. 
                    if (secId === selectedTopic) {
                        sec.classList.remove('hidden-section');
                    } else {
                        sec.classList.add('hidden-section');
                    }
                }
            });
            calculateTotal(); // Recalculate because hidden inputs shouldn't count? Or clear them?
            // Note: In this simple version, hidden inputs keep their values if already checked. 
        }

        function calculateTotal() {
            // Ch·ªâ t√≠nh ƒëi·ªÉm c√°c ph·∫ßn ƒêANG HI·ªÇN TH·ªä
            // (Ho·∫∑c t√≠nh t·∫•t c·∫£ n·∫øu mu·ªën gi·ªØ ƒëi·ªÉm khi chuy·ªÉn tab - ·ªü ƒë√¢y ta ch·ªçn t√≠nh t·∫•t c·∫£ ƒë√£ check)
            const inputs = document.querySelectorAll('input[type="radio"]:checked');
            let total = 0;
            inputs.forEach(input => {
                // Ki·ªÉm tra xem input n√†y c√≥ thu·ªôc section ƒëang b·ªã ·∫©n kh√¥ng?
                // Tuy nhi√™n ƒë·ªÉ ƒë∆°n gi·∫£n, c·ª© c·ªông h·∫øt c√°c √¥ ƒë√£ tick.
                total += parseInt(input.value);
            });
            document.getElementById('totalScoreDisplay').innerText = total;
        }

        // --- SUBMIT ---
        function submitForm() {
            // 1. Validation
            const evaluator = document.getElementById('evaluator').value;
            const p1 = document.getElementById('presenter1').value;
            const p2 = document.getElementById('presenter2').value;
            const topic = document.getElementById('topicSelect').value;
            
            if (!evaluator) { showModal('error', 'Ch∆∞a ch·ªçn ng∆∞·ªùi ch·∫•m', 'Vui l√≤ng cho bi·∫øt b·∫°n l√† ai.'); return; }
            if (!p1) { showModal('error', 'Ch∆∞a ch·ªçn ng∆∞·ªùi tr√¨nh b√†y', 'Vui l√≤ng ch·ªçn √≠t nh·∫•t 1 sinh vi√™n tr√¨nh b√†y.'); return; }

            // T·∫°o chu·ªói t√™n nh√≥m/ng∆∞·ªùi tr√¨nh b√†y
            let groupNameInfo = p1;
            if (p2) groupNameInfo += " & " + p2;
            groupNameInfo += ` [${topic}]`; // Th√™m ch·ªß ƒë·ªÅ v√†o t√™n nh√≥m ƒë·ªÉ d·ªÖ theo d√µi trong Sheet

            // 2. Collect Scores
            // QUAN TR·ªåNG: Ph·∫£i thu th·∫≠p ƒë·ªß 17 c·ªôt ƒëi·ªÉm theo ƒë√∫ng th·ª© t·ª± file Sheet c≈©
            // Th·ª© t·ª± trong rubricData: P1 (4 ti√™u ch√≠) -> P2 (3) -> P3 (4) -> ALL (2) -> Exercise (trong code c·ª©ng ch∆∞a th√™m v√†o loop rubricData, c·∫ßn x·ª≠ l√Ω ri√™ng)
            // Tuy nhi√™n ·ªü tr√™n ta render rubricData g·ªìm 4 ph·∫ßn.
            // Ph·∫ßn b√†i t·∫≠p (Exercise) l√† 1 radio ri√™ng name="exercise".
            
            // T·ªïng c·ªông ti√™u ch√≠ trong rubricData: 4 + 3 + 4 + 2 = 13 ti√™u ch√≠.
            // Sheet c≈© c·ªßa b·∫°n c√≥ 17 ti√™u ch√≠ (5.1 -> 5.4 l√† b√†i t·∫≠p).
            // => Logic mapping:
            // 1.1->1.4 (4)
            // 2.1->2.3 (3)
            // 3.1->3.4 (4)
            // 4.1->4.2 (2)
            // 5.1->5.4 (4) -> Trong form m·ªõi t√¥i g·ªôp l·∫°i th√†nh 1 ƒëi·ªÉm Exercise chung (1-5) ƒë·ªÉ ƒë∆°n gi·∫£n cho l·ªõp nh·ªè, 
            // NH∆ØNG ƒë·ªÉ kh·ªõp v·ªõi sheet c≈©, t√¥i s·∫Ω ƒëi·ªÅn ƒëi·ªÉm Exercise n√†y v√†o c·∫£ 4 c·ªôt cu·ªëi (5.1->5.4) ho·∫∑c ƒëi·ªÅn v√†o 5.1, c√°c c·ªôt kia ƒë·ªÉ 0.
            
            let scores = [];
            
            // L·∫•y ƒëi·ªÉm c√°c ph·∫ßn trong rubricData (1.1 ƒë·∫øn 4.2)
            rubricData.forEach(s => s.criteria.forEach(c => {
                const checked = document.querySelector(`input[name="${c.id}"]:checked`);
                // N·∫øu section b·ªã ·∫©n (kh√¥ng ch·∫•m ph·∫ßn ƒë√≥), ta g·ª≠i ƒëi·ªÉm 0
                // Ho·∫∑c ng∆∞·ªùi d√πng ch∆∞a tick
                scores.push(checked ? parseInt(checked.value) : 0);
            }));

            // L·∫•y ƒëi·ªÉm b√†i t·∫≠p (Exercise)
            const exerciseChecked = document.querySelector('input[name="exercise"]:checked');
            const exScore = exerciseChecked ? parseInt(exerciseChecked.value) : 0;
            
            // Map v√†o 4 c·ªôt cu·ªëi c·ªßa Sheet (5.1, 5.2, 5.3, 5.4)
            // V√¨ form r√∫t g·ªçn ch·ªâ c√≥ 1 ƒëi·ªÉm b√†i t·∫≠p chung
            scores.push(exScore); // 5.1
            scores.push(exScore); // 5.2 (Gi·∫£ l·∫≠p ƒëi·ªÉm t∆∞∆°ng ƒë∆∞∆°ng)
            scores.push(exScore); // 5.3
            scores.push(exScore); // 5.4

            const feedback = (document.getElementById('feedback_strong').value + " | " + document.getElementById('feedback_weak').value).trim();

            const payload = {
                role: "SinhVien", // M·∫∑c ƒë·ªãnh
                evaluator: evaluator,
                groupName: groupNameInfo,
                week: new Date().toLocaleDateString('vi-VN'), // G·ª≠i ng√†y thay v√¨ tu·∫ßn
                scores: [...scores, feedback, ""] // Th√™m feedback v√†o cu·ªëi m·∫£ng ƒëi·ªÉm
            };

            // G·ª≠i d·ªØ li·ªáu
            document.getElementById('loadingOverlay').classList.remove('hidden');
            
            fetch(SCRIPT_URL, {
                method: 'POST',
                mode: 'no-cors',
                headers: { 'Content-Type': 'text/plain;charset=utf-8' },
                body: JSON.stringify(payload)
            })
            .then(() => {
                document.getElementById('loadingOverlay').classList.add('hidden');
                showModal('success', 'ƒê√£ g·ª≠i ƒëi·ªÉm!', `ƒê√£ ch·∫•m cho ${groupNameInfo}`);
                // Kh√¥ng reset form ho√†n to√†n ƒë·ªÉ ch·∫•m b·∫°n ti·∫øp theo cho nhanh
                // Ch·ªâ b·ªè tick ƒëi·ªÉm
                document.querySelectorAll('input[type="radio"]').forEach(el => el.checked = false);
                document.getElementById('totalScoreDisplay').innerText = "0";
            })
            .catch(err => {
                document.getElementById('loadingOverlay').classList.add('hidden');
                showModal('error', 'L·ªói', 'Ki·ªÉm tra m·∫°ng v√† th·ª≠ l·∫°i.');
            });
        }

        // Modal Utils
        function showModal(type, title, msg) {
            const m = document.getElementById('statusModal');
            document.getElementById('modalTitle').innerText = title;
            document.getElementById('modalMessage').innerText = msg;
            document.getElementById('modalIcon').innerHTML = type === 'success' ? '<i class="fas fa-check-circle text-green-500"></i>' : '<i class="fas fa-exclamation-triangle text-red-500"></i>';
            m.classList.remove('hidden');
        }
        function closeModal() { document.getElementById('statusModal').classList.add('hidden'); }
    </script>
</body>
</html>



